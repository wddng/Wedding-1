<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Scan QR Buku Tamu</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body{
  font-family:Arial;
  text-align:center;
  padding:16px;
}
#reader{
  width:300px;
  margin:auto;
}
#status{
  margin-top:14px;
  font-size:15px;
}
</style>
</head>
<body>

<h3>ðŸ“¸ Scan QR Tamu</h3>
<div id="reader"></div>
<div id="status">Arahkan kamera ke QR</div>

<script>
let qr;

function startScan(){
  Html5Qrcode.getCameras().then(cameras => {
    if(!cameras.length){
      alert("Kamera tidak ditemukan");
      return;
    }

    // Ambil kamera BELAKANG (biasanya index terakhir)
    const cameraId = cameras[cameras.length - 1].id;

    qr = new Html5Qrcode("reader");
    qr.start(
      cameraId,
      {
        fps: 8,
        qrbox: { width: 220, height: 220 }
      },
      onScanSuccess,
      err => {}
    );

  }).catch(err => {
    alert("Error kamera: " + err);
  });
}

function onScanSuccess(text){
  document.getElementById("status").innerHTML =
    "âœ… Scan berhasil:<br><b>" + text + "</b>";

  // STOP kamera setelah 1 scan (WAJIB)
  qr.stop();
}

// START SETELAH PAGE READY
window.addEventListener("load", startScan);
</script>

</body>
</html>
